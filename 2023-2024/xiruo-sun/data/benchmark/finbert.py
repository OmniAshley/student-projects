# -*- coding: utf-8 -*-
"""finBert.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1TTgSyRGLHrqmCwr6WsrF62ldZ270S8tP
"""

import pandas

headlines_df = pandas.read_csv('/content/Sentences_AllAgree1.txt',sep='.@', names=['headline','sensation'])
headlines_df

headlines_df=headlines_df.sample(n=200)
headlines_df.to_csv('/content/financial_phrasebank.csv')

headlines_df

"""# 新段落"""

!pip install transformers

#Getting the tokenizer and the model

from transformers import AutoTokenizer, AutoModelForSequenceClassification, pipeline

tokenizer = AutoTokenizer.from_pretrained("ProsusAI/finbert")

model = AutoModelForSequenceClassification.from_pretrained("ProsusAI/finbert")

sensation = pipeline("text-classification", model=model, tokenizer=tokenizer)

import numpy as np
headlines_array = np.array(headlines_df)
headlines_list=list(headlines_array[:,0])
headlines_list

senti_results = sensation(headlines_list)
senti_results

strength=[i['score'] for i in senti_results]

headlines_df['strength']=strength

headlines_df

headlines_df.to_csv('/content/finBert_benchmark.csv')